import{r as h,P as W,p as Y,o as l,d as i,a as t,i as F,j as $,b as y,w as u,n as S,h as x,e as m,t as a,g as d,F as k,f as z,u as b,v as K,J as V}from"./app-e263ac0f.js";import{D as Q}from"./vue3-easy-data-table.es-1512132d.js";import{i as w}from"./index.min-40c7dc60.js";import X from"./GestionRendezVous2-7bd49c51.js";import{H as Z,F as tt}from"./FooterDocteur-aa572583.js";import{f as et}from"./index-ed97a630.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./typeof-7fd5df1e.js";const ot={class:"iq-card"},st=t("div",{class:"iq-card-header d-flex justify-content-between iq-bg-secondary",style:{"background-color":"#ceebee"}},[t("div",{class:"iq-header-title"},[t("h5",{class:"card-title text-dark"},"Liste Viste Terminée")])],-1),nt={class:"iq-card-body"},at={class:"form-group col-md-6 col-lg-4"},lt={class:"d-flex justify-content-center align-items-center"},it=["disabled","onClick"],rt=t("i",{class:"ri-exchange-dollar-line"},null,-1),dt=[rt],ct=["onClick","disabled"],ut=t("i",{class:"ri-printer-line text-white"},null,-1),mt=[ut],_t=["onClick"],ht=t("i",{class:"ri-calendar-line text-white"},null,-1),pt=[ht],vt=["onClick"],bt=t("i",{class:"ri-eye-line"},null,-1),gt=[bt],ft=["onClick"],yt=t("i",{class:"ri-exchange-dollar-line"},null,-1),xt=[yt],kt={key:0,class:"text-danger font-weight-bold font-size-16"},wt=t("span",{class:"text-dark font-size-16"},"DH",-1),Dt={key:0,class:"text-success font-weight-bold font-size-16"},Pt=t("span",{class:"text-dark font-size-16"},"DH",-1),Rt={class:"text-dark font-weight-bold"},Ct=t("span",{class:"text-danger font-size-18"},"Aucune visite pour le moment",-1),Mt={key:0,class:"modal-overlay"},Ft={class:"modal-dialog",role:"document"},St={class:"modal-content",style:{"background-color":"#eff7f8"}},zt={class:"modal-header bg-secondary"},Vt={key:0,class:"modal-title text-white"},Tt=t("span",{"aria-hidden":"true"},"×",-1),Nt=[Tt],$t={class:"modal-body"},Bt={class:"row text-center"},Lt={key:0,class:"col-lg-6",style:{"font-size":"20px",color:"black","font-weight":"bold"}},jt={key:1,class:"col-lg-6",style:{"font-size":"20px",color:"black","font-weight":"bold"}},Ht={key:0,class:"row mt-4 ml-2"},It={class:"col-lg-12 text-dark"},qt={class:"font-weight-bold"},At={class:"font-weight-bold"},Et={class:"text-danger"},Ot={class:"font-weight-bold"},Gt={class:"row"},Jt={class:"col-lg-12 ml-2 mt-2"},Ut=t("option",{selected:"",disabled:""},"Mode Paiement",-1),Wt=t("option",{value:"Cash"},"Cash",-1),Yt=t("option",{value:"Chéque"},"Chéque",-1),Kt=t("option",{value:"Virement"},"Virement",-1),Qt=[Ut,Wt,Yt,Kt],Xt={class:"modal-footer"},Zt=["disabled"],te={class:"modal-dialog modal-lg"},ee={class:"modal-content"},oe=t("h5",{class:"modal-title text-white"}," Note d'honoration ",-1),se={key:0,class:"modal-body"},ne={id:"printable-contentFactureDone"},ae={class:"header",style:{"text-align":"center"}},le={style:{"font-size":"15px"}},ie=t("h1",{class:"facture mt-2"},"Note d'honoration",-1),re={class:"mt-2",style:{"font-size":"18px"}},de={class:"invoice-details",style:{"font-size":"23px","font-family":"Verdana, Geneva, Tahoma, sans-serif",color:"black","text-align":"justify"}},ce={border:"1",style:{width:"100%"}},ue=t("thead",{class:"text-center"},[t("tr",null,[t("th",null,"N°"),t("th",null,"Désignation"),t("th",null,"Montant")])],-1),me={class:"text-center"},_e={class:"center"},he={class:"center text-center"},pe=t("td",{colspan:"2",class:"text-start font-weight-bold center"},"Total ",-1),ve={class:"center font-weight-bold"},be={class:"text-left text-black",id:"footer-facture",style:{"font-size":"12px"}},ge={class:"footer-cer"},fe={class:"text-right"},ye=t("i",{class:"ri-printer-line"},null,-1),xe={class:"modal-dialog",role:"document"},ke={class:"modal-content",style:{"background-color":"#eff7f8"}},we={class:"modal-header bg-secondary"},De={key:0,class:"modal-title text-white"},Pe=t("span",{"aria-hidden":"true"},"×",-1),Re=[Pe],Ce={class:"modal-body"},Me={class:"row text-center"},Fe={key:0,class:"col-lg-6",style:{"font-size":"20px",color:"black","font-weight":"bold"}},Se={key:1,class:"col-lg-6",style:{"font-size":"20px",color:"black","font-weight":"bold"}},ze={key:0,class:"row mt-4 ml-2"},Ve={class:"table-responsive-md w-100"},Te={class:"table table-bordered table-striped text-center"},Ne=t("thead",null,[t("tr",null,[t("th",null,"Date"),t("th",null,"Motif"),t("th",null,"Montant"),t("th",null,"Supprimer")])],-1),$e={contenteditable:"false"},Be={contenteditable:"false"},Le={class:"table-remove"},je=["onClick"],He={data(){return{showModal:null,modalTitle:"My Modal",modalCloseButton:"Close",modalSaveButton:"Save",locale:"",currentPatient:null,newRendezVousDate:new Date,SelectedPatient:null}},methods:{reverseDate(p){return p.split("-").reverse().join("-")},printInvoice(){const p=document.getElementById("printable-contentFactureDone").innerHTML,_=window.open("","_blank");_.document.open(),_.document.write(`
        <html>
        <head>
            <style>
                body {
                    margin: 0;
                    padding: 0;
                }
                .print-container {
                    margin-top: 110px;
                    padding: 10px;
                }
                .invoice-details {
                    line-height: 1.9;
                }
                .invoice-details table td {
                    text-align: center;
                }
                .invoice-details table td, .invoice-details table th {
                    border: 1px solid black;
                }
            </style>
        </head>
        <body>
            <div class="print-container">${p}</div>
        </body>
        </html>
    `),_.document.close(),_.focus(),_.print(),_.close()}},mounted(){document.addEventListener("DOMContentLoaded",()=>{this.printInvoice()})}},We=Object.assign(He,{__name:"ListDone",props:{items:Object,rowPerPage:Number,formatedDate:"",docteurs:Object},setup(p){const _=h(""),B=h(["nomPatient","prenomPatient","cinPatient"]),o=h(null),T=h(null),N=h(new Date),D=h(null),P=h(null),R=h(null),g=h(!1),L=p,c=W({dateReglement:"",montantReglement:"",modePaiement:"Cash",motifVisite:"",patient_id:"",user_id:""}),j=s=>{o.value=s,R.value.style.display="block"},H=()=>{R.value.style.display="none",o.value=null},I=s=>{V.get(route("patients.show",s.patient))},q=()=>{const s=et(N.value,"yyyy-MM-dd");c.dateReglement=s,c.patient_id=o.value.patient.id,c.user_id=o.value.docteur.id,c.motifVisite=o.value.patient.statutPatient,g.value=!0,V.visit("ReglementFacture",{method:"post",data:c,preserveState:!0,preserveScroll:!0,errorBag:null,forceFormData:!1,onProgress:n=>{},onSuccess:n=>{w.useToast().success("Réglement Vous  Ajouter",{position:"bottom-right",duration:3e3}),C(),g.value=!1},onError:n=>{w.useToast().error("Veuillez remplir tout les champs",{position:"bottom-right",duration:3e3}),g.value=!1}})},f=Y(()=>{if(o.value){const s=parseFloat(c.montantReglement),n=c.modePaiement;if(s==0||s<0||v(o.value)<s||isNaN(s)||!n)return!1}return!0});L.items.forEach(s=>{s.radioState="Primary"});const A=[{text:"Nom",value:"patient.nomPatient",sortable:!0},{text:"Prénom",value:"patient.prenomPatient",sortable:!0},{text:"Assurance",value:"Patientassurance",sortable:!0},{text:"Motif De Visite",value:"patient.statutPatient",sortable:!0},{text:"Montant",value:"montantFacture",sortable:!0},{text:"Reglement",value:"montantReglement",sortable:!0},{text:"Facture",value:"operation",sortable:!0},{text:"Patient",value:"patient",sortable:!0},{text:"Imprimer",value:"show",sortable:!0},{text:"Rendez Vous",value:"rendezVous",sortable:!0},{text:"Supprimer Reglement",value:"reglement",sortable:!0}],v=s=>{const n=s.patient.TotalByDoctorToDay;for(let e=0;e<n.length;e++)if(s.user_id==n[e].id)return n[e].total_factures-n[e].total_reglements},E=s=>{o.value=s,D.value.style.display="block"},C=()=>{D.value.style.display="none",o.value=null},O=s=>{o.value=s,P.value.style.display="block"},M=()=>{P.value.style.display="none",o.value=null},G=s=>{T.value=s.patient};function J(s){if(!(s instanceof Date))return"";const n=String(s.getDate()).padStart(2,"0"),e=String(s.getMonth()+1).padStart(2,"0"),r=s.getFullYear();return`${n}-${e}-${r}`}const U=s=>{V.delete(`/ReglementFacture/${s.id}`,{preserveState:!0,preserveScroll:!0,data:s,forceFormData:!0,errorBag:null,forceFormData:!1,onSuccess:n=>{w.useToast().info("Reglement Supprimer",{position:"bottom-right",duration:3e3}),M()},onError:n=>{w.useToast().error("Erreur Lors de La  Suppression",{position:"bottom-right",duration:3e3})}})};return(s,n)=>(l(),i(k,null,[t("div",ot,[st,t("div",nt,[t("div",at,[F(t("input",{type:"search",class:"form-control",placeholder:"Chercher patient",id:"cno","onUpdate:modelValue":n[0]||(n[0]=e=>_.value=e)},null,512),[[$,_.value]])]),y(b(Q),{"buttons-pagination":"",items:p.items,headers:A,"search-value":_.value,"hide-footer:search-field":B.value,"rows-per-page":p.rowPerPage,alternating:""},{"item-operation":u(e=>[t("div",lt,[t("button",{class:S([v(e)!=0?"btn-danger":"btn-success","btn"]),disabled:v(e)===0,type:"button",onClick:x(r=>E(e),["prevent"])},dt,10,it)])]),"item-show":u(e=>[t("button",{type:"button",onClick:r=>j(e),"data-toggle":"modal","data-target":".bd-FactureviewDone-modal-lg",disabled:v(e)!==0,class:S([v(e)!=0?"btn-danger":"btn-success","btn btn-secondary m-2"])},mt,10,ct)]),"item-rendezVous":u(e=>[t("button",{type:"button","data-toggle":"modal",onClick:r=>G(e),"data-target":".bd-GestionRendezVous2-modal-lg",class:"btn btn-warning m-2"},pt,8,_t)]),"item-patient":u(e=>[t("button",{onClick:x(r=>I(e),["prevent"]),class:"btn btn-info",title:"Details Patient"},gt,8,vt)]),"item-reglement":u(e=>[t("button",{class:"btn btn-danger",type:"button",onClick:x(r=>O(e),["prevent"])},xt,8,ft)]),"item-motif":u(e=>[m(a(e.statutPatient),1)]),"item-DateFacture":u(e=>[m(a(e.dateFacture),1)]),"item-montantFacture":u(e=>[e.factures[0]?(l(),i("span",kt,[m(a(e.factures[0].montantFacture)+" ",1),wt])):d("",!0)]),"item-montantReglement":u(e=>[(l(!0),i(k,null,z(e.patient.TotalByDoctorToDay,r=>(l(),i("span",{key:r.id},[e.user_id==r.id?(l(),i("span",Dt,[m(a(r.total_reglements)+" ",1),Pt])):d("",!0)]))),128))]),"item-Patientassurance":u(e=>[t("span",Rt,a(e.patient.assurance.typeAssurance),1)]),"empty-message":u(()=>[Ct]),_:1},8,["items","search-value","hide-footer:search-field","rows-per-page"])])]),o.value?(l(),i("div",Mt)):d("",!0),t("div",{class:"modal",tabindex:"-1",role:"dialog",ref_key:"addReglementModal",ref:D},[t("div",Ft,[t("div",St,[t("div",zt,[o.value?(l(),i("h5",Vt,"Reglement "+a(o.value.patient.nomPatient),1)):d("",!0),t("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",onClick:C},Nt)]),t("div",$t,[t("div",Bt,[o.value?(l(),i("div",Lt,a(o.value.patient.prenomPatient+" "+o.value.patient.nomPatient),1)):d("",!0),o.value?(l(),i("div",jt,a(J(N.value)),1)):d("",!0)]),o.value?(l(),i("div",Ht,[t("div",It,[t("p",qt,"Date Facture : "+a(o.value.factures[0].dateFacture),1),t("p",null,[m("Consulter Par Dr. "),t("span",null,a(o.value.docteur.name),1)]),t("p",At,[m("Montant Facture : "),t("span",Et,a(v(o.value)+" DH"),1)]),t("p",Ot,[F(t("input",{"onUpdate:modelValue":n[1]||(n[1]=e=>b(c).montantReglement=e),type:"text",onInput:n[2]||(n[2]=(...e)=>s.handleMontantInputChange&&s.handleMontantInputChange(...e)),class:"form-control mt-3 bg-white",id:"montantReglement",placeholder:"Saisir le Montant à régler"},null,544),[[$,b(c).montantReglement]])])])])):d("",!0),t("div",Gt,[t("div",Jt,[F(t("select",{class:"form-control","onUpdate:modelValue":n[3]||(n[3]=e=>b(c).modePaiement=e)},Qt,512),[[K,b(c).modePaiement]])])])]),t("div",Xt,[t("button",{type:"button",style:{"font-size":"16px"},class:S({"btn btn-secondary text-white":!f.value,"btn btn-success":f.value,"btn btn-danger":!f.value}),disabled:!f.value||g.value,onClick:q}," Ajouter Réglement ",10,Zt),t("button",{type:"button",style:{"font-size":"16px"},class:"btn btn-secondary","data-dismiss":"modal",onClick:C}," Annuler ")])])])],512),y(X,{docteurs:p.docteurs,currentPatient:T.value},null,8,["docteurs","currentPatient"]),t("div",{class:"modal",tabindex:"-1",role:"dialog",ref_key:"FactureModal",ref:R},[m(' aria-hidden="true"> '),t("div",te,[t("div",ee,[t("form",{onSubmit:n[5]||(n[5]=x((...e)=>s.submit&&s.submit(...e),["prevent"]))},[t("div",{class:"modal-header bg-secondary"},[oe,t("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[t("span",{"aria-hidden":"true",onClick:H},"×")])]),o.value?(l(),i("div",se,[y(Z),t("div",ne,[t("div",ae,[t("h4",le," Taroudant Le : "+a(o.value.factures[0].dateFacture)+" : تارودانت في ",1),ie,t("h4",re,a(o.value.patient.nomPatient+" "+o.value.patient.prenomPatient),1)]),t("div",de,[t("table",ce,[ue,t("tbody",me,[(l(!0),i(k,null,z(JSON.parse(o.value.factures[0].soins),(e,r)=>(l(),i("tr",{key:r},[t("td",_e,a(r+1),1),t("td",null,a(e.libelleSoin),1),t("td",he,a(e.montantSoin+" DH"),1)]))),128)),t("tr",null,[pe,t("td",ve,a(o.value.factures[0].montantFacture+" DH"),1)])])]),t("p",be,[m(" Arrêter la Présente Note à la Somme de "),t("span",null,a(o.value.factures[0].montantLettre),1),m(" Dirhams ("),t("span",null,a(o.value.factures[0].montantFacture),1),m(" DH ) ")])])]),t("div",ge,[y(tt)]),t("div",fe,[t("button",{style:{"font-size":"20px"},onClick:n[4]||(n[4]=e=>s.printInvoice()),type:"button",class:"btn btn-outline-primary mt-3"},[ye,m("Imprimer ")])])])):d("",!0)],32)])])],512),t("div",{class:"modal",tabindex:"-1",role:"dialog",ref_key:"deleteReglementModal",ref:P},[t("div",xe,[t("div",ke,[t("div",we,[o.value?(l(),i("h5",De,"Reglement "+a(o.value.patient.nomPatient),1)):d("",!0),t("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",onClick:M},Re)]),t("div",Ce,[t("div",Me,[o.value?(l(),i("div",Fe,a(o.value.patient.prenomPatient+" "+o.value.patient.nomPatient),1)):d("",!0),o.value?(l(),i("div",Se)):d("",!0)]),o.value?(l(),i("div",ze,[t("div",Ve,[t("table",Te,[Ne,t("tbody",null,[(l(!0),i(k,null,z(o.value.patient.reglement_facture,e=>(l(),i("tr",{key:e.id},[t("td",$e,a(e.dateReglement),1),t("td",Be,a(e.motifVisite),1),t("td",null,a(e.montantReglement)+" DH ",1),t("td",null,[t("span",Le,[t("button",{type:"button",onClick:r=>U(e),class:"btn iq-bg-danger btn-rounded btn-sm my-0"},"Supprimer",8,je)])])]))),128))])])])])):d("",!0)]),t("div",{class:"modal-footer"},[t("button",{type:"button",style:{"font-size":"16px"},class:"btn btn-danger","data-dismiss":"modal",onClick:M}," Fermer ")])])])],512)],64))}});export{We as default};
