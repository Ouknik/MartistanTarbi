import{r as d,P as N,q as T,y as q,o as s,d as n,a as e,h as J,t as l,u as a,z as P,g as f,i as S,j as O,A as D,F as y,f as k,e as x,v as R,b as G,J as V,C as H,D as K}from"./app-e263ac0f.js";import{i as E}from"./index.min-40c7dc60.js";import Q from"./CreateMedicament-668a0d1a.js";import{_ as W}from"./_plugin-vue_export-helper-c27b6911.js";const c=r=>(H("data-v-c38a90f8"),r=r(),K(),r),X={key:0,class:"modal fade bd-OrdonnanceEdit-modal-lg",tabindex:"-1",role:"dialog",style:{display:"none"},id:"updateOrdonnance","aria-hidden":"true"},Y={class:"modal-dialog modal-lg"},Z={class:"modal-content"},ee={class:"modal-header bg-secondary"},te={class:"modal-title text-white"},oe=c(()=>e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")],-1)),se={hidden:""},ne={class:"modal-body p-5"},ae={class:"row"},ie={class:"col-lg-6"},de={class:"form-group"},le=c(()=>e("label",{for:"medicament"},"Recherche Médicament : ",-1)),ce={key:0,class:"liste-medicaments"},re=["onClick"],ue={key:1},me={key:0,type:"button",class:"btn btn-outline-primary mb-3","data-toggle":"modal","data-target":"#AddMedicament"},pe=c(()=>e("i",{class:"ri-add-fill"},null,-1)),_e={key:1,class:"col-lg-6"},he=c(()=>e("label",{class:"prescription"}," Prescriptions",-1)),ve=c(()=>e("option",{value:"",disabled:""},"Sélectionnez une prescription",-1)),ge=["value"],fe=c(()=>e("div",null,null,-1)),ye={class:"row mt-2"},be={class:"col-lg-11"},Me={style:{"font-weight":"bold"}},Se=["onClick"],ke=c(()=>e("i",{class:"ion-trash-b text-danger"},null,-1)),we={class:"row p-0",style:{"margin-top":"-15px"}},Oe={class:"col-lg-11"},xe=["onUpdate:modelValue"],Ce={key:0},De={class:"row mt-2"},Ve={class:"col-lg-11"},$e={style:{"font-weight":"bold"}},Ee=["onClick"],Be=c(()=>e("i",{class:"ion-trash-b text-danger"},null,-1)),Ue={class:"row p-0",style:{"margin-top":"-15px"}},ze=["onUpdate:modelValue"],Ae={class:"modal-footer"},Fe=c(()=>e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Annuler ",-1)),Ie={__name:"EditOdonnance",props:{ordonnance:Object,medicaments:Object},setup(r){const B=d([]),U=d(""),z=d("");let u=d(""),h=d([]),v=d(null),b=d([]),p=d(null),m=d([]);const _=r;let w=d(_.medicaments);const C=N({medicaments:m,Ordonnance:_.ordonnance});T(()=>{w.value=_.medicaments,window.Echo.channel("get-medicaments").listen("Medicaments",o=>{w.value=o.medicaments})});const A=o=>{V.visit(`/ordonnances/${o.id}`,{method:"put",data:C,preserveState:!0,preserveScroll:!0,errorBag:null,forceFormData:!1,preserveState:!0,preserveScroll:!0,onSuccess:i=>{E.useToast().success("Ordonnance Modifier",{position:"bottom-right",duration:3e3}),$("#updateOrdonnance").modal("hide"),m.value=[]}})},F=(o,i)=>{V.delete(`/ordonnances/${o}/medicament/${i}`,{preserveState:!0,preserveScroll:!0,errorBag:null,forceFormData:!1,preserveState:!0,preserveScroll:!0,onSuccess:t=>{E.useToast().success("Medicament Bien Supprimer",{position:"bottom-right",duration:3e3}),$("#updateOrdonnance").modal("hide")}})},I=()=>{h.value=u.value?w.value.filter(o=>o.nomMedicament.toLowerCase().includes(u.value.toLowerCase())):[]},j=o=>{v.value=o,b.value=o.prescriptions||[],u.value="",h.value=[],b.value.length===0&&m.value.push({medicament_id:o.id,nomMedicament:o.nomMedicament,dosageMedicament:o.dosageMedicament,uniteDosageMedicament:o.uniteDosageMedicament,prescription:" "})};q(p,o=>{o&&(m.value.push({...o,nomMedicament:v.value.nomMedicament,dosageMedicament:v.value.dosageMedicament,uniteDosageMedicament:v.value.uniteDosageMedicament}),p.value=null)});const L=o=>{m.value.splice(o,1)};return(o,i)=>(s(),n(y,null,[r.ordonnance?(s(),n("div",X,[e("div",Y,[e("div",Z,[e("form",{onSubmit:i[3]||(i[3]=J((...t)=>o.submit&&o.submit(...t),["prevent"]))},[e("div",ee,[e("h5",te,"Modifier Ordonnance "+l(r.ordonnance.dateOrdonnance),1),oe]),e("span",se,l(a(C).Ordonnance=_.ordonnance),1),e("div",ne,[e("div",ae,[B.value?(s(),n("label",{key:0,style:P(z.value)},l(U.value),5)):f("",!0),e("div",ie,[e("div",de,[le,S(e("input",{type:"text",class:"form-control",id:"email1",onInput:I,"onUpdate:modelValue":i[0]||(i[0]=t=>D(u)?u.value=t:u=t)},null,544),[[O,a(u)]])]),a(h).length>0?(s(),n("ul",ce,[(s(!0),n(y,null,k(a(h),t=>(s(),n("li",{key:t.id,onClick:M=>j(t)},l(t.nomMedicament),9,re))),128))])):(s(),n("ul",ue,[a(h).length===0&&a(u).length>0?(s(),n("button",me,[pe,x(" Ajouter Médicament ")])):f("",!0)]))]),a(v)&&a(b).length>0?(s(),n("div",_e,[he,S(e("select",{class:"form-control my-2","onUpdate:modelValue":i[1]||(i[1]=t=>D(p)?p.value=t:p=t)},[ve,(s(!0),n(y,null,k(a(b),t=>(s(),n("option",{key:t.id,value:t},l(t.prescription),9,ge))),128))],512),[[R,a(p)]])])):f("",!0)]),fe,(s(!0),n(y,null,k(r.ordonnance.medicaments,(t,M)=>(s(),n("div",{key:t.id},[e("div",ye,[e("div",be,[e("h5",Me,[e("a",{onClick:g=>F(_.ordonnance.id,t.id),class:"iq-icons-list",href:"#"},[ke,x(l(t.nomMedicament+" "+t.dosageMedicament+" "+t.uniteDosageMedicament),1)],8,Se)])])]),e("div",we,[e("div",Oe,[S(e("input",{type:"text",class:"form-control ml-1","onUpdate:modelValue":g=>t.pivot.prescription=g},null,8,xe),[[O,t.pivot.prescription,void 0,{lazy:!0}]])])])]))),128)),a(m).length?(s(),n("div",Ce,[(s(!0),n(y,null,k(a(m),(t,M)=>(s(),n("div",{key:M},[e("div",De,[e("div",Ve,[e("h5",$e,[e("a",{onClick:g=>L(M),class:"iq-icons-list",href:"#"},[Be,x(l(t.nomMedicament)+" "+l(t.dosageMedicament)+" "+l(t.uniteDosageMedicament),1)],8,Ee)])])]),e("div",Ue,[S(e("input",{type:"text",class:"form-control ml-3","onUpdate:modelValue":g=>t.prescription=g},null,8,ze),[[O,t.prescription,void 0,{lazy:!0}]])])]))),128))])):f("",!0),e("div",Ae,[Fe,e("button",{type:"submit",onClick:i[2]||(i[2]=t=>A(_.ordonnance)),class:"btn btn-primary"}," Modifier ")])])],32)])])])):f("",!0),G(Q)],64))}},qe=W(Ie,[["__scopeId","data-v-c38a90f8"]]);export{qe as default};
