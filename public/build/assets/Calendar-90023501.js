import{C as s,i as c}from"./index-12e56fa7.js";import{r as d,q as l,o as p,d as u}from"./app-e263ac0f.js";const m={ref:"calendar"},f={data(){return{patients:[]}},computed:{combinedEvents(){const a=this.rendezvous.map(e=>({id:e.patient.id,title:e.patient.nomPatient+" "+e.patient.prenomPatient,start:e.dateRendezVous,color:e.docteur.id==1?"#a6a6a6":"#01c1cc",textColor:"#000000",dateNaissance:e.patient.dateNaissancePatient,age:e.patient.age,numeroCarte:e.patient.cinPatient,docteur:e.docteur.name,type:"patient"})),r=this.rendezvous.reduce((e,n)=>{const t=n.docteur.id,o=new Date(n.dateRendezVous).toLocaleDateString();return e[t]||(e[t]={}),e[t][o]?(e[t][o].count++,e[t][o].title=`${n.docteur.name}</br> (${e[t][o].count} Rendez-Vous)`):e[t][o]={id:t,title:`${n.docteur.name}</br>  (1 Rendez-Vous)`,start:n.dateRendezVous,color:t==1?"#91BBF2":"#0367A6",textColor:"#000000",type:"docteur",count:1},e},{}),i=[];for(const e in r){const n=Object.values(r[e]);i.push(...n)}return[...i,...a]}},methods:{renderCalendar(){let a=this.$refs.calendar;a.style.width="100%",a.style.height="300px",a.parentElement.style.display="flex",a.parentElement.style.alignItems="center",a.parentElement.style.justifyContent="center";const r=this.combinedEvents.slice().sort((e,n)=>e.type==="docteur"&&n.type!=="docteur"?-1:e.type!=="docteur"&&n.type==="docteur"?1:0);new s(this.$refs.calendar,{plugins:[c],headerToolbar:{left:"prev",center:"title",right:"next,today"},buttonText:{today:"Aujourdhui",day:"Jour",month:"Mois"},locale:"fr",firstDay:1,events:r,dayMaxEvents:2,views:{timeGrid:{dayMaxEventRows:2}},eventContent:function(e){let t=`<a href="/patients/${e.event.id}" class="text-white" style="font-size: 14px">${e.event.title}</a>`;return e.event.type==="docteur"&&(t+=`</br><p style="font-size: 12px;">Docteur: ${e.event.title}</p>`,t+=`</br><p style="font-size: 12px;">${e.event.count} </p>`),{html:t}},moreLinkClick:function(e){(e.view.type==="timeGridWeek"||e.view.type==="timeGridDay")&&(e.jsEvent.preventDefault(),this.changeView("timeGridDay",e.date))}}).render()}},mounted(){this.renderCalendar()}},x=Object.assign(f,{__name:"Calendar",props:{rendezvous:Object},setup(a){const r=a;let i=d(r.rendezvous);return l(()=>{i.value=r.rendezvous,window.Echo.channel("calendar-doctor").listen("CalendarDoctor",e=>{i.value=e.calendarDoctor})}),(e,n)=>(p(),u("div",m,null,512))}});export{x as default};
