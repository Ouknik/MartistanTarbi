import{r as l,P as N,p as F,o as r,d as i,a as e,t as c,i as x,j as P,b as S,w as g,n as k,h as j,e as f,u,g as d,F as q,J as T}from"./app-e263ac0f.js";import{D as $}from"./vue3-easy-data-table.es-1512132d.js";import{i as R}from"./index.min-40c7dc60.js";const B={class:"iq-card"},E={class:"iq-card-header d-flex justify-content-between",style:{"background-color":"#ceebee"}},H=e("div",{class:"iq-header-title"},[e("h4",{class:"card-title"},"Liste des patients")],-1),L={class:"iq-header-title"},U={class:"col-md-4"},J={class:"training-block d-flex align-items-center"},O=e("div",{class:"rounded-circle iq-card-icon iq-bg-primary"},[e("i",{class:"ri-exchange-dollar-line fa-2x mr-2"})],-1),Y={class:"ms-3"},G={class:"text-success mt-2"},I=e("p",{class:"mb-0"},"Revenu/Permis",-1),K={class:"iq-card-body"},Q={class:"form-group col-md-6 col-lg-4"},W={class:"row"},X={class:"d-flex justify-content-center align-items-center mb-1 mt-1"},Z=["disabled","onClick"],ee=e("i",{class:"ri-exchange-dollar-line"},null,-1),te=[ee],se={class:"text-success font-weight-bold font-size-16"},oe=e("span",{class:"text-dark font-size-16"},"DH",-1),ae=e("a",{href:""},"Aucun patient avec les données saisie",-1),ne={key:0,class:"modal-overlay"},le={class:"modal-dialog",role:"document"},re={class:"modal-content",style:{"background-color":"#eff7f8"}},ie=e("h5",{class:"modal-title text-black"},"Encaisser La Facture",-1),ce=e("span",{"aria-hidden":"true"},"×",-1),de=[ce],ue={class:"modal-body"},me={key:0,class:"row text-center"},_e={class:"col-lg-12"},he={class:"row text-center"},ve={key:0,class:"col-lg-6",style:{"font-size":"20px",color:"black","font-weight":"bold"}},pe={key:1,class:"col-lg-6",style:{"font-size":"20px",color:"black","font-weight":"bold"}},be={key:1,class:"row m-4"},ge={hidden:""},fe={class:"form-group col-md-4 col-lg-6"},ye=e("label",{class:"control-label align-self-center mb-1",for:"lname"},[e("span",{style:{color:"#eff7f8","font-size":"1.2em"}},"*"),f(" Montant A Payer")],-1),xe=["value"],Pe={key:0,class:"form-group col-md-4 col-lg-6"},ke=e("label",{class:"control-label align-self-center mb-1",for:"lname"},[e("span",{style:{color:"red","font-size":"1.2em"}},"*"),f(" Montant Regler")],-1),Re=["max"],we={class:"modal-footer"},De=["disabled"],Ve={hidden:""},Ce={__name:"List",props:{items:Object,rowPerPage:Number,docteurs:Object},setup(_){const h=l(""),w=l(["nom","prenom"]),t=l(null),D=l(new Date),v=l(null);l(null);const V=l(0),z=[{text:"N° Dossier",value:"numeroDossier",sortable:!0},{text:"Nom",value:"nom",sortable:!0},{text:"Prénom",value:"prenom",sortable:!0},{text:"Date Visite",value:"dateVisite",sortable:!0},{text:"Montant à Payer",value:"montantAPayer",sortable:!0},{text:"Montant regler",value:"montantRegler",sortable:!0},{text:"Reglement",value:"operation",sortable:!0}],n=N({montantReglement:"",modePaiement:"Cash",motifVisite:"Permis",patient_id:"",user_id:"",idPatientPermis:""}),A=s=>{n.patient_id=s.patient_id,T.visit(`permis/${s.id}`,{method:"PUT",data:n,preserveState:!0,preserveScroll:!0,errorBag:null,forceFormData:!1,onProgress:a=>{},onSuccess:a=>{R.useToast().success("Réglement  Ajouter",{position:"bottom-right",duration:3e3}),p()},onError:a=>{R.useToast().error("Veuillez remplir tout les champs",{position:"bottom-right",duration:3e3})}})},M=s=>{t.value=s,v.value.style.display="block"},p=()=>{v.value.style.display="none",t.value=null};function C(s){if(!(s instanceof Date))return"";const a=String(s.getDate()).padStart(2,"0"),o=String(s.getMonth()+1).padStart(2,"0"),y=s.getFullYear();return`${a}-${o}-${y}`}const b=s=>s.montantAPayer-s.montantPayer,m=F(()=>{if(t.value){const s=parseFloat(n.montantReglement);if(parseFloat(t.value.montantAPayer),b(t.value)!=s||isNaN(s))return!1}return!0});return(s,a)=>(r(),i(q,null,[e("div",B,[e("div",E,[H,e("div",L,[e("div",U,[e("div",J,[O,e("div",Y,[e("h3",G,c(_.docteurs[0].TotalRevenuPermis)+" DH",1),I])])])])]),e("div",K,[e("div",Q,[x(e("input",{type:"search",class:"form-control",placeholder:"Chercher patient",id:"cno","onUpdate:modelValue":a[0]||(a[0]=o=>h.value=o)},null,512),[[P,h.value]])]),S(u($),{"buttons-pagination":"",items:_.items,headers:z,"search-value":h.value,"hide-footer:search-field":w.value,"rows-per-page":_.rowPerPage,alternating:""},{"item-operation":g(o=>[e("div",W,[e("div",X,[e("button",{class:k([b(o)!=0?"btn-danger":"btn-success","btn"]),disabled:b(o)===0,type:"button",onClick:j(y=>M(o),["prevent"])},te,10,Z)])])]),"item-montantRegler":g(o=>[e("span",se,[f(c(o.montantPayer)+" ",1),oe])]),"empty-message":g(()=>[ae]),_:1},8,["items","search-value","hide-footer:search-field","rows-per-page"])])]),t.value?(r(),i("div",ne)):d("",!0),e("div",{class:"modal",tabindex:"-1",role:"dialog",ref_key:"addRendezVousModal",ref:v},[e("div",le,[e("div",re,[e("div",{class:"modal-header",style:{"background-color":"#ffb177"}},[ie,e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",onClick:p},de)]),e("div",ue,[t.value?(r(),i("div",me,[e("div",_e,[e("h2",null,"N° Dossier "+c(t.value.numeroDossier),1)])])):d("",!0),e("div",he,[t.value?(r(),i("div",ve,c(t.value.nom+" "+t.value.prenom),1)):d("",!0),t.value?(r(),i("div",pe,c(C(D.value)),1)):d("",!0)]),t.value?(r(),i("div",be,[e("span",ge,c(u(n).idPatientPermis=t.value.id),1),e("div",fe,[ye,e("input",{type:"text",class:"form-control text-dark",id:"lname",value:t.value.montantAPayer+" DH",disabled:""},null,8,xe)]),t.value?(r(),i("div",Pe,[ke,x(e("input",{type:"text","onUpdate:modelValue":a[1]||(a[1]=o=>u(n).montantReglement=o),max:V.value,class:"form-control",id:"lname"},null,8,Re),[[P,u(n).montantReglement]])])):d("",!0)])):d("",!0)]),e("div",we,[e("button",{type:"button",style:{"font-size":"16px"},class:k({"btn btn-secondary text-white":!m.value,"btn btn-success":m.value,"btn btn-danger":!m.value}),disabled:!m.value,onClick:a[2]||(a[2]=o=>A(t.value))}," Ajouter Réglement ",10,De),e("button",{type:"button",style:{"font-size":"16px"},class:"btn btn-secondary","data-dismiss":"modal",onClick:p}," Annuler ")])])])],512),e("span",Ve,c(u(n).user_id=s.$page.props.user.id),1)],64))}};export{Ce as default};
