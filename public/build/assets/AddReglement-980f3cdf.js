import{P as x,r as D,y as w,p as B,o as a,d,a as t,F as g,f,t as _,e as h,i as r,v as p,u as l,j as v,J as S}from"./app-e263ac0f.js";import{i as b}from"./index.min-40c7dc60.js";const C={class:"iq-card"},M={class:"iq-card-body"},T={class:"row justify-content-center align-items-center mb-2"},k=["value"],A={class:"text-dark font-weight-bold"},F={class:"text-danger font-weight-bold"},j=t("hr",null,null,-1),N={class:"row mt-2"},E={class:"col-lg-4"},U={class:"form-group"},q=t("label",{for:"cinPatient"},"CIN Patient :",-1),z=["value"],J={class:"col-lg-4"},O={class:"form-group"},$=t("label",{for:"cinPatient"},"Nom Patient :",-1),H=["value"],I={class:"col-lg-4"},L={class:"form-group"},G=t("label",{for:"cinPatient"},"Prénom Patient :",-1),K=["value"],Q=t("hr",null,null,-1),W={class:"row mt-2"},X={class:"form-group col-md-4 col-lg-4"},Y=t("label",{class:"control-label align-self-center mb-1"},"Docteur",-1),Z=["value"],tt={class:"form-group col-md-4 col-lg-4"},et=t("label",{class:"control-label align-self-center mb-1"},"Motif",-1),ot=["value"],st={class:"form-group col-md-4 col-lg-4"},nt=t("label",{class:"control-label align-self-center mb-1"},"Mode",-1),lt=t("option",{value:"Cash"},"Cash",-1),it=t("option",{value:"BiVirementlan"},"Virement",-1),at=t("option",{value:"Chéque"},"Chéque",-1),dt=[lt,it,at],ct={class:"row mt-2"},rt={class:"form-group col-md-4 col-lg-6"},mt=t("label",{class:"control-label align-self-center mb-1"},"Date Réglement",-1),ut={class:"form-group col-md-4 col-lg-6"},_t=t("label",{class:"control-label align-self-center mb-1"},"Montant A Regler",-1),gt=["max"],ft={class:"d-flex justify-content-center mt-2"},pt=["disabled"],ht=t("i",{class:"ri-check-double-line"},null,-1),Pt={__name:"AddReglement",props:{items:Object,motifVisite:Object},setup(i){const m=i,e=x({montantReglement:"",modePaiement:"Cash",motifVisite:m.items.statutPatient,patient_id:"",user_id:"",dateReglement:""}),u=D(0),P=()=>{const n=new Event("reglementAdded");window.dispatchEvent(n)};w(()=>[e.user_id,m.items.TotalByDoctor],([n])=>{const s=m.items.TotalByDoctor.find(o=>o.id===n);s?u.value=s.total_factures-s.total_reglements:u.value=0});const R=B(()=>{const n=e.montantReglement!==""&&!isNaN(parseFloat(e.montantReglement))&&parseFloat(e.montantReglement)>0,s=e.user_id!=="",o=e.modePaiement!=="",c=parseFloat(e.montantReglement);return!(n&&s&&o&&c<=u.value)}),y=n=>{e.patient_id=n.id,S.visit("ReglementFacture",{method:"post",data:e,preserveState:!0,preserveScroll:!0,errorBag:null,forceFormData:!1,onProgress:s=>{},onSuccess:s=>{b.useToast().success("Réglement  Ajouter",{position:"bottom-right",duration:3e3}),P(),e.montantReglement="",e.modePaiement="Cash",e.motifVisite=m.items.statutPatient,e.patient_id="",e.user_id=""},onError:s=>{b.useToast().error("Veuillez remplir tout les champs",{position:"bottom-right",duration:3e3})}})},V=n=>n.total_factures-n.total_reglements;return(n,s)=>(a(),d("div",C,[t("div",M,[t("div",T,[(a(!0),d(g,null,f(i.items.TotalByDoctor,(o,c)=>(a(),d("div",{key:c,value:o.id,class:"col-md-6 col-lg-6 text-center font-size-17"},[t("span",A,_(o.nom),1),h(" - "),t("span",F,_(V(o)+" DH"),1)],8,k))),128))]),j,t("div",N,[t("div",E,[t("div",U,[q,t("input",{value:i.items.cinPatient,type:"text",id:"cinPatient",class:"form-control",disabled:""},null,8,z)])]),t("div",J,[t("div",O,[$,t("input",{value:i.items.nomPatient,type:"text",id:"cinPatient",class:"form-control",disabled:""},null,8,H)])]),t("div",I,[t("div",L,[G,t("input",{value:i.items.prenomPatient,type:"text",id:"cinPatient",class:"form-control",disabled:""},null,8,K)])])]),Q,t("div",W,[t("div",X,[Y,r(t("select",{name:"docteur_id",class:"form-control",id:"docteur_id","onUpdate:modelValue":s[0]||(s[0]=o=>l(e).user_id=o)},[(a(!0),d(g,null,f(i.items.TotalByDoctor,(o,c)=>(a(),d("option",{key:c,value:o.id},_(o.nom),9,Z))),128))],512),[[p,l(e).user_id]])]),t("div",tt,[et,r(t("select",{name:"motifReglement",class:"form-control",id:"motifReglement","onUpdate:modelValue":s[1]||(s[1]=o=>l(e).motifVisite=o)},[(a(!0),d(g,null,f(i.motifVisite,o=>(a(),d("option",{value:o.motifVisite},_(o.motifVisite),9,ot))),256))],512),[[p,l(e).motifVisite]])]),t("div",st,[nt,r(t("select",{name:"modePaiement",class:"form-control",id:"modePaiement","onUpdate:modelValue":s[2]||(s[2]=o=>l(e).modePaiement=o)},dt,512),[[p,l(e).modePaiement]])])]),t("div",ct,[t("div",rt,[mt,r(t("input",{type:"date",id:"montantReglement",class:"form-control","onUpdate:modelValue":s[3]||(s[3]=o=>l(e).dateReglement=o)},null,512),[[v,l(e).dateReglement]])]),t("div",ut,[_t,r(t("input",{type:"number",id:"montantReglement",class:"form-control","onUpdate:modelValue":s[4]||(s[4]=o=>l(e).montantReglement=o),max:u.value},null,8,gt),[[v,l(e).montantReglement]])])]),t("div",ft,[t("button",{onClick:s[5]||(s[5]=o=>y(n.$props.items)),type:"button",class:"btn btn-primary custom-width",disabled:R.value},[ht,h("Régler ")],8,pt)])])]))}};export{Pt as default};
